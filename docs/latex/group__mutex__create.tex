\doxysection{mutex\+\_\+create}
\hypertarget{group__mutex__create}{}\label{group__mutex__create}\index{mutex\_create@{mutex\_create}}
semphr. h 
\begin{DoxyPre}sem\_t mutex\_create( void )\end{DoxyPre}


Creates a new mutex type semaphore instance, and returns a handle by which the new mutex can be referenced.

Internally, within the Free\+RTOS implementation, mutex semaphores use a block of memory, in which the mutex structure is stored. If a mutex is created using mutex\+\_\+create() then the required memory is automatically dynamically allocated inside the mutex\+\_\+create() function. (see \href{http://www.freertos.org/a00111.html}{\texttt{ http\+://www.\+freertos.\+org/a00111.\+html}}). If a mutex is created using mutex\+\_\+create\+\_\+static() then the application writer must provided the memory. mutex\+\_\+create\+\_\+static() therefore allows a mutex to be created without using any dynamic memory allocation.

Mutexes created using this function can be accessed using the sem\+\_\+wait() and sem\+\_\+post() macros. The mutex\+\_\+recursive\+\_\+take() and mutex\+\_\+recursive\+\_\+give() macros must not be used.

This type of semaphore uses a priority inheritance mechanism so a task \textquotesingle{}taking\textquotesingle{} a semaphore MUST ALWAYS \textquotesingle{}give\textquotesingle{} the semaphore back once the semaphore it is no longer required.

Mutex type semaphores cannot be used from within interrupt service routines.

See sem\+\_\+binary\+\_\+create() for an alternative implementation that can be used for pure synchronisation (where one task or interrupt always \textquotesingle{}gives\textquotesingle{} the semaphore and another always \textquotesingle{}takes\textquotesingle{} the semaphore) and from within interrupt service routines.

\begin{DoxyReturn}{Returns}
If the mutex was successfully created then a handle to the created semaphore is returned. If there was not enough heap to allocate the mutex data structures then NULL is returned.
\end{DoxyReturn}
Example usage\+: 
\begin{DoxyPre}
sem\_t xSemaphore;

void vATask( void * pvParameters )
\{
   // Semaphore cannot be used before a call to mutex\_create().
   // This is a macro so pass the variable in directly.
   xSemaphore = mutex\_create();

   if( xSemaphore != NULL )
   \{
       // The semaphore was created successfully.
       // The semaphore can now be used.
   \}
\}
\end{DoxyPre}
 